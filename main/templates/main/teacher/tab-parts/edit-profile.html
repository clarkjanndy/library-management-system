{% load static %}

<form enctype="multipart/form-data" id="edit-teacher" method="POST" action="/teachers/{{teacher.user.id_no}}/edit">
    {% csrf_token %}

    <div class="row mb-2 form-group text-theme">
        <div class="col-xl-3 col-lg-3 col-md-5">
            <label>Profile Picture</label>
        </div>
        <div class="col-xl-9 col-lg-9 col-md-7">
            <img width="100" class="mb-2" id="preview" src="{% get_media_prefix %}{{teacher.user.photo}}">

            <div>
                <input type="file" id="photo" name="photo" accept="image/*" hidden>
                <label for="photo" class="btn btn-theme"><span class="bx bx-upload"></span></label>
            </div>
        </div>
    </div>

    <div class="row mb-2 form-group text-theme">
        <div class="col-xl-3 col-lg-3 col-md-5">
            <label>First Name</label>
        </div>
        <div class="col-xl-9 col-lg-9 col-md-7">
            <input type="text" id="first_name" name="first_name" class="form-control" placeholder="First Name"
                value="{{teacher.user.first_name}}">
        </div>
        <div class="is-invalid"></div>
    </div>

    <div class="row mb-2 form-group text-theme">
        <div class="col-xl-3 col-lg-3 col-md-5">
            <label>Middle Name</label>
        </div>
        <div class="col-xl-9 col-lg-9 col-md-7">
            <input type="text" id="middle_name" name="middle_name" class="form-control" placeholder="Middle Name"
                value="{{teacher.user.middle_name}}">
        </div>
        <div class="is-invalid"></div>
    </div>

    <div class="row mb-2 form-group text-theme">
        <div class="col-xl-3 col-lg-3 col-md-5">
            <label>Last Name</label>
        </div>
        <div class="col-xl-9 col-lg-9 col-md-7">
            <input type="text" id="last_name" name="last_name" class="form-control" placeholder="Last Name"
                value="{{teacher.user.last_name}}">
        </div>
        <div class="is-invalid"></div>
    </div>

    <div class="row mb-2 form-group text-theme">
        <div class="col-xl-3 col-lg-3 col-md-5">
            <label>Ext. Name</label>
        </div>
        <div class="col-xl-9 col-lg-9 col-md-7">
            <input type="text" id="ext_name" name="ext_name" class="form-control" placeholder="Extension Name"
                value="{{teacher.user.ext_name}}">
        </div>
        <div class="is-invalid"></div>
    </div>

    <div class="row mb-2 form-group text-theme">
        <div class="col-xl-3 col-lg-3 col-md-5">
            <label>Gender</label>
        </div>
        <div class="col-xl-9 col-lg-9 col-md-7">
            <select id="gender" name="gender" class="form-select">
                <option value="">--select--</option>
                <option value="male" {%if teacher.user.gender == 'male' %}selected{% endif %}>Male</option>
                <option value="female" {%if teacher.user.gender == 'female' %}selected{% endif %}>Female</option>
            </select>
        </div>
        <div class="is-invalid"></div>
    </div>

    <div class="row mb-2 form-group text-theme">
        <div class="col-xl-3 col-lg-3 col-md-5">
            <label>Civil Status</label>
        </div>
        <div class="col-xl-9 col-lg-9 col-md-7">
            <select id="civil_status" name="civil_status" class="form-select">
                <option value="">--select--</option>
                <option value="single" {%if teacher.user.civil_status == 'single' %}selected{% endif %}>Single</option>
                <option value="married" {%if teacher.user.civil_status == 'married' %}selected{% endif %}>Married</option>
                <option value="widowed" {%if teacher.user.civil_status == 'widowed' %}selected{% endif %}>Widowed</option>
            </select>
        </div>
        <div class="is-invalid"></div>
    </div>

    <div class="row mb-2 form-group text-theme">
        <div class="col-xl-3 col-lg-3 col-md-5">
            <label>Address</label>
        </div>
        <div class="col-xl-9 col-lg-9 col-md-7">
            <input type="text" id="address" name="address" class="form-control" placeholder="Address"
                value="{{teacher.user.address}}">
        </div>
        <div class="is-invalid"></div>
    </div>

    <div class="row mb-2 form-group text-theme">
        <div class="col-xl-3 col-lg-3 col-md-5">
            <label>Contact No.</label>
        </div>
        <div class="col-xl-9 col-lg-9 col-md-7">
            <input type="text" id="contact_no" name="contact_no" class="form-control" placeholder="Contact No."
                value="{{teacher.user.contact_no}}">
        </div>
        <div class="is-invalid"></div>
    </div>

    <div class="row mb-2 form-group text-theme">
        <div class="col-xl-3 col-lg-3 col-md-5">
            <label>Designation</label>
        </div>
        <div class="col-xl-9 col-lg-9 col-md-7">
            <input type="text" id="designation" name="designation" class="form-control" placeholder="Designation"
                value="{{teacher.designation}}">
        </div>
        <div class="is-invalid"></div>
    </div>

    <div class="row mb-2 form-group text-theme">
        <div class="col-xl-3 col-lg-3 col-md-5">
            <label>Years of Exp</label>
        </div>
        <div class="col-xl-9 col-lg-9 col-md-7">
            
                <input type="text" id="year_of_exp" name="year_of_exp" class="form-control" placeholder="Years Of Exp"
                    value="{{teacher.year_of_exp}}">
          
        </div>
        <div class="is-invalid"></div>
    </div>

    <div class="row mb-2 form-group text-theme">
        <div class="col-xl-3 col-lg-3 col-md-5">
            <label>Advisory</label>
        </div>
        <div class="col-xl-9 col-lg-9 col-md-7">
            <input type="text" id="advisory" name="advisory" class="form-control" placeholder="Advisory"
                value="{{teacher.advisory}}">
        </div>
        <div class="is-invalid"></div>
    </div>

    <div class="d-flex justify-content-end">
        <button type="submit" class="btn btn-theme">Save Changes</button>
    </div>

</form>

<script>
    photo.onchange = evt => {
        const [file] = photo.files
        if (file) {
            preview.src = URL.createObjectURL(file)
        }
    }
</script>


<script>
    const validation = new window.JustValidate('#edit-teacher', {
        errorFieldCssClass: 'is-invalid',
    });

    validation
        .addField('#photo', [{
            rule: 'required',
            errorMessage: 'This field is required',
        },])
        .addField('#first_name', [{
            rule: 'required',
            errorMessage: 'This field is required',
        },])
        .addField('#last_name', [{
            rule: 'required',
            errorMessage: 'This field is required',
        },])
        .addField('#gender', [{
            rule: 'required',
            errorMessage: 'This field is required',
        },])
        .addField('#civil_status', [{
            rule: 'required',
            errorMessage: 'This field is required',
        },])
        .addField('#address', [{
            rule: 'required',
            errorMessage: 'This field is required',
        },])
        .addField('#contact_no', [{
            rule: 'required',
            errorMessage: 'This field is required',
        }, {
            rule: 'minLength',
            value: 11,
            errorMessage: 'Minimum length og 11 numbers',
        }, {
            rule: 'maxLength',
            value: 11,
            errorMessage: 'Maximum length og 11 numbers only',
        }, {
            rule: 'number',
            errorMessage: 'Input a valid contact number',
        }])
        .addField('#designation', [{
            rule: 'required',
            errorMessage: 'This field is required',
        },])
        .addField('#year_of_exp', [{
            rule: 'required',
            errorMessage: 'This field is required',
        }, {
            rule: 'number',
            errorMessage: 'Input a valid contact number',
        }])
        .onSuccess((event) => {
            document.getElementById("edit-teacher").submit();
        });

</script>